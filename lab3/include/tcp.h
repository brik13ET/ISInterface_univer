#pragma once

#include <stdint.h>
// ╔════════╦════════╦════════╦════════╦════════╦════════╦════════╦════════╗
// ║  0x00  ║  0x01  ║  0x02  ║  0x03  ║  0x04  ║  0x05  ║  0x06  ║  0x07  ║
// ╠════════╬════════╬════════╬════════╬════════╬════════╬════════╬════════╣
// ║76543210║76543210║76543210║76543210║76543210║76543210║76543210║76543210║
// ╠════════╬════════╬════════╬════════╬════════╬════════╬════════╬════════╣
// ║   Source port   ║Destination port ║          Sequence number          ║
// ╚════════╩════════╩════════╩════════╩════════╩════════╩════════╩════════╝
// ╔════════╦════════╦════════╦════════╦════════╦════════╦════════╦════════╗
// ║  0x08  ║  0x09  ║  0x0a  ║  0x0b  ║  0x0c  ║  0x0d  ║  0x0e  ║  0x0f  ║
// ╠════════╬════════╬════════╬════════╬════════╬════════╬════════╬════════╣
// ║76543210║76543210║76543210║76543210║76543210║76543210║76543210║76543210║
// ╠════════╬════════╬════════╬════════╬═══╦╦═══╬════════╬════════╬════════╣
// ║       Acknowledgment number       ║HL ║║   FLAGS    ║   Window size   ║
// ╚════════╩════════╩════════╩════════╩═══╩╩═══╩════════╩════════╩════════╝
// ╔════════╦════════╦════════╦════════╦════════╦════════╦════════╦════════╗
// ║  0x10  ║  0x11  ║  0x12  ║  0x13  ║  0x14 ╍ ╍ ╍ ╍ ╍ ╍ ╍ ╍ ╍ ╍ ╍ 0x27  ║
// ╠════════╬════════╬════════╬════════╬════════╬════════╬════════╬════════╣
// ║76543210║76543210║76543210║76543210║76543210║76543210║76543210║76543210║
// ╠════════╬════════╬════════╬════════╬════════╬════════╬════════╬════════╣
// ║     Checksum    ║Urgent pointer=0 ║            TCP Options            ║
// ╚════════╩════════╩════════╩════════╩════════╩════════╩════════╩════════╝

typedef struct 
{
    uint16_t    src_port;
    uint16_t    dest_port;
    uint32_t    seq_number;
    uint32_t    ack_number;
    uint8_t     HL : 4;
    uint16_t    FLAGS : 12;
    uint16_t    win_size;
    uint16_t    checksum;
    uint16_t    urgent_ptr;
    uint32_t    tcp_opts;
} __attribute__((packed)) tcp_header;
